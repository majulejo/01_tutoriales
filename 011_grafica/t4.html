<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Tr√≠ptico Final - Informaci√≥n por Box</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        outline: none;
      }
      body {
        font-family: "Poppins", sans-serif;
        padding: 20px;
        background-color: #f8f9fa;
      }
      header {
        background-color: #333;
        color: white;
        padding: 1em;
        text-align: center;
      }
      main {
        padding: 20px;
      }
      .pagina {
        display: none;
      }
      .pagina.active {
        display: block;
      }
      .columna {
        margin-bottom: 1.5rem;
        padding: 1rem;
        background: #ffffff;
        border: 1px solid #ddd;
        border-radius: 6px;
      }
      label {
        font-weight: 600;
        display: block;
        margin-top: 10px;
      }
      input[type="text"],
      input[type="date"],
      input[type="tel"],
      input[type="number"],
      textarea {
        width: 100%;
        padding: 6px;
        margin-top: 4px;
        margin-bottom: 10px;
        border-radius: 4px;
        border: 1px solid #ccc;
        box-sizing: border-box;
      }
      textarea {
        resize: vertical;
      }
      button {
        margin-top: 10px;
        margin-right: 10px;
        padding: 8px 16px;
        background-color: #007bff;
        border: none;
        border-radius: 4px;
        color: white;
        cursor: pointer;
      }
      button:hover {
        background-color: #0056b3;
      }
      #info-box {
        font-size: 1.2rem;
        margin-bottom: 20px;
      }
      #box-selector,
      #info-box,
      button,
      .pagina h2 {
        text-align: center;
        margin-left: auto;
        margin-right: auto;
        display: block;
      }
      .columna {
        display: inline-block;
        text-align: left;
        vertical-align: top;
        margin: 1em;
        padding: 1em;
        border: 1px solid #ccc;
        border-radius: 8px;
        background-color: #ffffff;
        text-align: center;
      }
      .columna input[type="text"],
      .columna input[type="date"],
      .columna input[type="tel"],
      .columna input[type="number"] {
        width: 90%;
        margin: 0.3em auto;
        display: block;
        text-align: center;
        font-size: 1rem;
      }
      .columna textarea {
        width: 90%;
        margin: 0.3em auto;
        display: block;
        text-align: center;
        font-size: 1rem;
      }
      .columna label {
        display: block;
        margin-top: 0.5em;
        font-weight: bold;
      }
      .grupo-alergias textarea {
        resize: vertical;
        min-height: 60px;
      }
      /* En la secci√≥n normal (no de impresi√≥n) */
      #alergias {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        box-sizing: border-box;
        min-height: 60px;
        resize: vertical;
        font-family: "Poppins", sans-serif;
      }
      .vgmr-group {
        display: flex;
        flex-direction: column;
        margin-top: 10px;
      }

      .vgmr-group label {
        font-weight: bold;
        margin-bottom: 5px;
      }

      .vgmr-inputs {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .vgmr-inputs input[type="date"] {
        flex: 1;
        min-width: 140px;
      }
      /* bot√≥n del Box seleccionado */
      .btn-box--active {
        background: #28a745 !important; /* verde ‚Äì elige el color que quieras */
        color: #fff !important;
        box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15) inset;
      }

      /* =============================================================== */
      /*          IMPRESI√ìN ‚Äì solo se ven los .print-only                */
      /* =============================================================== */
      @media print {
        /* 1 ‚ñ∏   tama√±o real del papel. 308 √ó 216 mm en tu caso -------- */
        @page {
          size: 216mm 308mm portrait; /* ancho √ó alto  */
          margin: 0;
        }

        /* 2 ‚ñ∏   oculta TODO el documento ------------------------------ */
        body * {
          display: none !important;
        }

        /* 3 ‚ñ∏   vuelve a mostrar solo la p√°gina activa ---------------- */
        .pagina.active {
          display: block !important;
          position: relative !important;
        }

        /* 4 ‚ñ∏   ‚Ä¶y dentro de ella, exclusivamente los ‚Äúfantasmas‚Äù ------ */
        .pagina.active .print-only,
        .pagina.active .print-only * {
          display: block !important;
          visibility: visible !important;
        }

        /* 5 ‚ñ∏   formato de los campos que realmente se imprimen ------- */
        .print-only input,
        .print-only textarea {
          position: absolute; /* conservan tus coordenadas  */
          width: 12cm; /* ajusta si lo necesitas     */
          font-size: 12pt;
          border: none;
          background: none;
          color: #000;
        }
        /* Oculta el icono del selector de fecha (todas las engines) */
        .print-only input[type="date"] {
          -webkit-appearance: none; /* Chrome / Edge / Safari */
          -moz-appearance: none; /* Firefox */
          appearance: none;
        }
        /* Chrome / Edge / Safari / Opera */
        .print-only input[type="date"]::-webkit-calendar-picker-indicator {
          display: none;
        }
        /* Firefox: oculta el icono del selector de fecha en modo impresi√≥n */
        .print-only input[type="date"]::-moz-calendar-picker-indicator {
          display: none !important;
        }
        /* Mantener todo el texto en una sola l√≠nea ---------------------------------*/
        .print-only input,
        .print-only textarea {
          /* evita que el navegador divida la cadena en varios saltos de l√≠nea */
          white-space: nowrap !important; /* Firefox + Chromium */
          overflow: visible !important; /* por si hubiera clipping        */
          word-break: normal !important; /* no cortes    */
          line-height: 1.1; /* un poquito m√°s de aire opcional*/
        }

        /* Algunos motores imprimen los <input type="text"> ‚Äúapretados‚Äù.
   Forzamos a que ocupen el ancho exacto de su contenido              */
        .print-only input {
          width: auto !important;
          min-width: 0 !important;
          padding: 0; /* ya ocultaste bordes y fondo, pero por si acaso */
        }
        #print_alergias {
          position: absolute;
          left: 14cm;
          top: 1.5cm;
          width: 7cm;
          min-height: 1cm;
          max-height: 3cm; /* Altura m√°xima antes de reducir fuente */
          white-space: pre-wrap;
          word-wrap: break-word;
          overflow: visible;
          font-size: 10pt;
          line-height: 1.2;
        }
      }
    </style>
  </head>
  <body>
    <div id="box-selector" style="margin-bottom: 1em">
      <div style="display: flex; flex-wrap: wrap; gap: 0.5em; margin: 0.5em 0">
        <button class="btn-box" onclick="seleccionarBox(1)">Box 1</button>
        <button class="btn-box" onclick="seleccionarBox(2)">Box 2</button>
        <button class="btn-box" onclick="seleccionarBox(3)">Box 3</button>
        <button class="btn-box" onclick="seleccionarBox(4)">Box 4</button>
        <button class="btn-box" onclick="seleccionarBox(5)">Box 5</button>
        <button class="btn-box" onclick="seleccionarBox(6)">Box 6</button>
        <button class="btn-box" onclick="seleccionarBox(7)">Box 7</button>
        <button class="btn-box" onclick="seleccionarBox(8)">Box 8</button>
        <button class="btn-box" onclick="seleccionarBox(9)">Box 9</button>
        <button class="btn-box" onclick="seleccionarBox(10)">Box 10</button>
        <button class="btn-box" onclick="seleccionarBox(11)">Box 11</button>
        <button class="btn-box" onclick="seleccionarBox(12)">Box 12</button>
      </div>
    </div>
    <div style="margin-top: 1em">
      <button onclick="mostrarPagina(1)">Mostrar Hoja 1</button>
      <button onclick="mostrarPagina(2)">Mostrar Hoja 2</button>
      <button onclick="mostrarPagina(3)">Mostrar Hoja 3</button>
    </div>
    <div
      id="info-box"
      style="margin: 1em 0; font-weight: bold; font-size: 1.2em"
    >
      Rellenando informaci√≥n del Box <span id="box-num" .></span>
      <button
        type="button"
        onclick="borrarDatos()"
        style="
          margin-left: 1em;
          padding: 0.4em 1em;
          background: #d9534f;
          color: #fff;
          border: none;
          border-radius: 4px;
          cursor: pointer;
        "
      >
        üóëÔ∏è Borrar Datos
      </button>
    </div>

    <!-- HOJA 1 -->
    <div id="pagina1" class="pagina">
      <h2>Hoja 1 - Datos Cl√≠nicos</h2>
      <button onclick="imprimirHoja()">Imprimir Hoja 1</button>

      <div class="print-only" style="position: absolute; visibility: hidden">
        <input
          type="text"
          id="print_nombre"
          style="left: 3.5cm; top: 0.5cm; position: absolute"
        />
        <input
          type="date"
          id="print_fecha"
          style="left: 15cm; top: 0.5cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo1"
          style="left: 5cm; top: 9.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo2"
          style="left: 5cm; top: 10cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo3"
          style="left: 5cm; top: 10.6cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo4"
          style="left: 5cm; top: 11.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo5"
          style="left: 5cm; top: 11.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo6"
          style="left: 5cm; top: 12.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo8"
          style="left: 4cm; top: 12.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo9"
          style="left: 4cm; top: 13.6cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo10"
          style="left: 7.5cm; top: 14.1cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo11"
          style="left: 4cm; top: 14.6cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo12"
          style="left: 4cm; top: 15.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo13"
          style="left: 7cm; top: 15.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo14"
          style="left: 4cm; top: 16.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo16"
          style="left: 2.5cm; top: 17.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo17"
          style="left: 2.5cm; top: 17.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo18"
          style="left: 2.5cm; top: 18.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo19"
          style="left: 2.5cm; top: 18.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo20"
          style="left: 2.5cm; top: 19.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo21"
          style="left: 2.5cm; top: 19.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo22"
          style="left: 2.5cm; top: 20.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo23"
          style="left: 6cm; top: 20.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo24"
          style="left: 6cm; top: 21.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo25"
          style="left: 6cm; top: 21.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo26"
          style="left: 5cm; top: 22.5cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo27"
          style="left: 5cm; top: 23.1cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo28"
          style="left: 5cm; top: 23.6cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo30"
          style="left: 2.5cm; top: 24.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo31"
          style="left: 2.5cm; top: 25.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo32"
          style="left: 2.5cm; top: 25.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo33"
          style="left: 2.5cm; top: 26.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo34"
          style="left: 2.5cm; top: 26.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo35"
          style="left: 2.5cm; top: 27.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo36"
          style="left: 2.5cm; top: 27.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo37"
          style="left: 2.5cm; top: 28.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo38"
          style="left: 2.5cm; top: 28.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo39"
          style="left: 2.5cm; top: 29.2cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo40"
          style="left: 2.5cm; top: 29.7cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo41"
          style="left: 2.5cm; top: 30.2cm; position: absolute"
        />
      </div>
      <div class="columna">
        <h3>Nombre, apellidos y fecha</h3>
        <label for="nombre">Nombre y Apellidos:</label>
        <input type="text" id="nombre" placeholder="Juan P√©rez" />
        <label for="fecha_ingreso">Fecha de ingreso:</label>
        <input type="date" id="fecha_ingreso" />
        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha" />
      </div>
      <div class="columna">
        <h3>Oxigenaci√≥n y Control de Glucemias</h3>
        <label for="campo1">PVC</label
        ><input type="text" id="campo1" placeholder="PVC" />
        <label for="campo2">OXIGENACI√ìN</label
        ><input type="text" id="campo2" placeholder="Oxigenaci√≥n" />
        <label for="campo3">SATURACI√ìN</label
        ><input type="text" id="campo3" placeholder="Saturaci√≥n" />
        <label for="campo4">EVA/ESCID</label
        ><input type="text" id="campo4" placeholder="Eva/Scid" />
        <label for="campo5">GLUCEMIA</label
        ><input type="text" id="campo5" placeholder="Glucemia" />
        <label for="campo6">INSULINA</label
        ><input type="text" id="campo6" placeholder="Insulina" />
      </div>
      <div class="columna">
        <h3>P√©rdidas</h3>
        <label for="campo8">DIURESIS</label><input type="text" id="campo8" />
        <label for="campo9">HECES</label><input type="text" id="campo9" />
        <label for="campo10">V√ìMITOS, SUDOR, FIEBRE</label
        ><input type="text" id="campo10" placeholder="TQN" />
        <label for="campo11">S.N.G.</label><input type="text" id="campo11" />
        <label for="campo12">Otros</label><input type="text" id="campo12" />
        <label for="campo13">CONTROL DE RESIDUOS</label
        ><input type="text" id="campo13" /> <label for="campo14">P.I.</label
        ><input type="text" id="campo14" />
      </div>
      <div class="columna">
        <h3>Fluidoterapia</h3>
        <label for="campo16">Fluidoterapia 1</label
        ><input type="text" id="campo16" />
        <label for="campo17">Fluidoterapia 2</label
        ><input type="text" id="campo17" />
        <label for="campo18">Fluidoterapia 3</label
        ><input type="text" id="campo18" />
        <label for="campo19">Fluidoterapia 4</label
        ><input type="text" id="campo19" />
        <label for="campo20">Fluidoterapia 5</label
        ><input type="text" id="campo20" />
        <label for="campo21">Fluidoterapia 6</label
        ><input type="text" id="campo21" />
        <label for="campo22">Fluidoterapia 7</label
        ><input type="text" id="campo22" />
      </div>
      <div class="columna">
        <h3>Ingresos y Medicaci√≥n</h3>
        <label for="campo23">SF+MEDICACI√ìN</label
        ><input type="text" id="campo23" />
        <label for="campo24">SANGRE/PLASMA</label
        ><input type="text" id="campo24" />
        <label for="campo25">AGUA END√ìGENA</label
        ><input
          type="text"
          id="campo25"
          readonly
          style="background-color: #ebe9e9; color: #555"
        />
      </div>
      <div class="columna">
        <h3>Nutrici√≥n</h3>
        <label for="campo26">Oral</label><input type="text" id="campo26" />
        <label for="campo27">Enteral</label><input type="text" id="campo27" />
        <label for="campo28">Parenteral</label
        ><input type="text" id="campo28" />
      </div>
      <div class="columna">
        <h3>Medicaci√≥n</h3>
        <label for="campo30">MEDICACI√ìN 1</label
        ><input type="text" id="campo30" />
        <label for="campo31">MEDICACI√ìN 2</label
        ><input type="text" id="campo31" />
        <label for="campo32">MEDICACI√ìN 3</label
        ><input type="text" id="campo32" />
        <label for="campo33">MEDICACI√ìN 4</label
        ><input type="text" id="campo33" />
        <label for="campo34">MEDICACI√ìN 5</label
        ><input type="text" id="campo34" />
        <label for="campo35">MEDICACI√ìN 6</label
        ><input type="text" id="campo35" />
        <label for="campo36">MEDICACI√ìN 7</label
        ><input type="text" id="campo36" />
        <label for="campo37">MEDICACI√ìN 8</label
        ><input type="text" id="campo37" />
        <label for="campo38">MEDICACI√ìN 9</label
        ><input type="text" id="campo38" />
        <label for="campo39">MEDICACI√ìN 10</label
        ><input type="text" id="campo39" />
        <label for="campo40">MEDICACI√ìN 11</label
        ><input type="text" id="campo40" />
        <label for="campo41">MEDICACI√ìN 12</label
        ><input type="text" id="campo41" />
      </div>
    </div>

    <!-- HOJA 2 -->
    <div id="pagina2" class="pagina">
      <h2>Hoja 2 - Edad, Historia Cl√≠nica y Cama</h2>
      <button onclick="imprimirHoja()">Imprimir Hoja 2</button>

      <div class="columna">
        <label for="campo69">Edad</label
        ><input type="number" id="campo69" placeholder="Edad" />
        <label for="campo70">N¬∫ H¬™ Cl√≠nica</label
        ><input type="number" id="campo70" placeholder="N¬∫ H¬™ Cl√≠nica" />
        <label for="campo71">Box</label
        ><input type="number" id="campo71" readonly />
        <label for="campo72">Hoja N¬∫</label
        ><input type="number" id="campo72" placeholder="Hoja N¬∫" />
      </div>
      <!-- HOJA 2: overlays definitivos -->
      <div class="print-only" style="position: absolute; visibility: hidden">
        <input
          id="print_campo69"
          style="left: 0.5cm; top: 0.5cm; position: absolute"
        />
        <input
          id="print_campo70"
          style="left: 5.5cm; top: 0.5cm; position: absolute"
        />
        <input
          id="print_campo71"
          style="left: 10cm; top: 0.5cm; position: absolute"
        />
        <input
          id="print_campo72"
          style="left: 15.5cm; top: 0.5cm; position: absolute"
        />
      </div>
    </div>

    <!-- HOJA 3 -->
    <div id="pagina3" class="pagina">
      <h2>Hoja 3 - Tel√©fonos, Alergias y Cat√©teres</h2>
      <button onclick="imprimirHoja()">Imprimir Hoja 3</button>

      <div class="print-only" style="position: absolute; visibility: hidden">
        <!-- telefonos y alergias -->
        <input
          type="text"
          id="print_telefono1_nombre"
          style="left: 2.5cm; top: 3cm; position: absolute"
        />
        <input
          type="tel"
          id="print_telefono1_numero"
          style="left: 6.5cm; top: 3cm; position: absolute"
        />
        <input
          type="text"
          id="print_telefono2_nombre"
          style="left: 2.5cm; top: 3.5cm; position: absolute"
        />
        <input
          type="tel"
          id="print_telefono2_numero"
          style="left: 6.5cm; top: 3.5cm; position: absolute"
        />

        <textarea
          id="print_alergias"
          readonly
          class="print-only"
          style="left: 14cm; top: 1.5cm; position: absolute"
        ></textarea>
        <!-- niveles -->
        <input
          type="text"
          id="print_campo42_nombre"
          style="left: 4.2cm; top: 14.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo42_fecha"
          style="left: 7.2cm; top: 14.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo43_nombre"
          style="left: 4.2cm; top: 15.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo43_fecha"
          style="left: 7.2cm; top: 15.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo44_nombre"
          style="left: 4.2cm; top: 15.8cm; position: absolute"
        />
        <input type="text" id="print_campo44" style="position: absolute" />
        <input
          type="text"
          id="print_campo45_nombre"
          style="left: 4.2cm; top: 16.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo45_fecha"
          style="left: 7.2cm; top: 16.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo46_nombre"
          style="left: 4.2cm; top: 16.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo46_fecha"
          style="left: 7.2cm; top: 16.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo47_fecha"
          style="left: 6cm; top: 17.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo48_fecha"
          style="left: 6cm; top: 17.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo49_fecha"
          style="left: 6cm; top: 18.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo50_fecha"
          style="left: 6cm; top: 18.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo51_nombre"
          style="left: 3.5cm; top: 19.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo51_fecha"
          style="left: 7.5cm; top: 19.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo52_nombre"
          style="left: 3.5cm; top: 19.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo52_fecha"
          style="left: 7.5cm; top: 19.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo53_fecha"
          style="left: 6cm; top: 20.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo54_fecha"
          style="left: 6cm; top: 20.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo55_fecha"
          style="left: 6cm; top: 21.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo56_nombre"
          style="left: 4cm; top: 21.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo56_fecha"
          style="left: 7.5cm; top: 21.8cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo57_nombre"
          style="left: 4cm; top: 22.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo57_fecha"
          style="left: 6cm; top: 22.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo57_proximo"
          readonly
          style="left: 9.5cm; top: 22.3cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo58_nombre"
          style="left: 3.6cm; top: 24.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo58_fecha"
          style="left: 8cm; top: 24.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo59_nombre"
          style="left: 3.6cm; top: 24.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo59_fecha"
          style="left: 8cm; top: 24.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo60_nombre"
          style="left: 3.6cm; top: 25.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo60_fecha"
          style="left: 8cm; top: 25.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo61_nombre"
          style="left: 3.6cm; top: 25.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo61_fecha"
          style="left: 8cm; top: 25.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo62_nombre"
          style="left: 3.6cm; top: 26.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo62_fecha"
          style="left: 8cm; top: 26.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo63_nombre"
          style="left: 3.6cm; top: 26.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo63_fecha"
          style="left: 8cm; top: 26.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo64_nombre"
          style="left: 3.6cm; top: 27.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo64_fecha"
          style="left: 8cm; top: 27.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo65_nombre"
          style="left: 3.6cm; top: 27.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo65_fecha"
          style="left: 8cm; top: 27.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo66_nombre"
          style="left: 3.6cm; top: 28.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo66_fecha"
          style="left: 8cm; top: 28.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo67_nombre"
          style="left: 3.6cm; top: 28.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo67_fecha"
          style="left: 8cm; top: 28.9cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo68_nombre"
          style="left: 3.6cm; top: 29.4cm; position: absolute"
        />
        <input
          type="text"
          id="print_campo68_fecha"
          style="left: 8cm; top: 29.4cm; position: absolute"
        />
      </div>
      <div class="columna">
        <label for="telefono1_nombre">Familiar 1</label
        ><input
          type="text"
          id="telefono1_nombre"
          placeholder="Nombre del contacto"
        /><input
          type="tel"
          id="telefono1_numero"
          placeholder="Tel√©fono del contacto"
        />
        <label for="telefono2_nombre">Familiar 2</label
        ><input
          type="text"
          id="telefono2_nombre"
          placeholder="Nombre del contacto"
        /><input
          type="tel"
          id="telefono2_numero"
          placeholder="Tel√©fono del contacto"
        />
        <label for="alergias">Alergias</label
        ><textarea id="alergias" rows="3" placeholder="NAMC"></textarea>
      </div>
      <div class="columna">
        <h2>Niveles</h2>
        <label for="campo42_nombre">Niveles 1</label
        ><input type="text" id="campo42_nombre" placeholder="Niveles 1" /><input
          type="date"
          id="campo42_fecha"
        />
        <label for="campo43_nombre">Niveles 2</label
        ><input type="text" id="campo43_nombre" placeholder="Niveles 2" /><input
          type="date"
          id="campo43_fecha"
        />
        <label for="campo44_nombre">Niveles 3</label
        ><input type="text" id="campo44_nombre" placeholder="Niveles 3" /><input
          type="date"
          id="campo44"
        />
        <label for="campo45_nombre">Niveles 4</label
        ><input type="text" id="campo45_nombre" placeholder="Niveles 4" /><input
          type="date"
          id="campo45_fecha"
        />
        <label for="campo46_nombre">Niveles 5</label
        ><input type="text" id="campo46_nombre" placeholder="Niveles 5" /><input
          type="date"
          id="campo46_fecha"
        />
      </div>
      <div class="columna">
        <h2>Pruebas Anal√≠ticas</h2>
        <label for="campo47_fecha">Inmunologia</label
        ><input type="date" id="campo47_fecha" />
        <label for="campo48_fecha">Serolog√≠a</label
        ><input type="date" id="campo48_fecha" />
        <label for="campo49_fecha">Virolog√≠a</label
        ><input type="date" id="campo49_fecha" />
        <label for="campo50_fecha">F. Hep√°tica</label
        ><input type="date" id="campo50_fecha" />
        <label for="campo51_fecha">Otras Pruebas 1</label
        ><input
          type="text"
          id="campo51_nombre"
          placeholder="Otras Pruebas 1"
        /><input type="date" id="campo51_fecha" />
        <label for="campo52_nombre">Otras Pruebas 2</label
        ><input
          type="text"
          id="campo52_nombre"
          placeholder="Otras Pruebas 2"
        /><input type="date" id="campo52_fecha" />
      </div>
      <div class="columna">
        <h2>Cultivos</h2>
        <label for="campo53_fecha">Hemocultivos</label
        ><input type="date" id="campo53_fecha" />
        <label for="campo54_fecha">Esputos/BAS</label
        ><input type="date" id="campo54_fecha" />
        <label for="campo55_fecha">Urocultivos</label
        ><input type="date" id="campo55_fecha" />
        <label for="campo56_fecha">Otros</label
        ><input type="text" id="campo56_nombre" />
        <input type="date" id="campo56_fecha" />
        <label for="campo57_fecha">VGMR</label
        ><input type="date" id="campo57_fecha" /><input
          type="date"
          id="campo57_proximo"
          readonly
        />
      </div>
      <div class="columna">
        <h2>Cat√©teres y tipo</h2>
        <label for="campo58_nombre">Cat√©ter y tipo 1</label
        ><input
          type="text"
          id="campo58_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo58_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo58_fecha" />
        <label for="campo59_nombre">Cat√©ter y tipo 2</label
        ><input
          type="text"
          id="campo59_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo59_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo59_fecha" />
        <label for="campo60_nombre">Cat√©ter y tipo 3</label
        ><input
          type="text"
          id="campo60_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo60_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo60_fecha" />
        <label for="campo61_nombre">Cat√©ter y tipo 4</label
        ><input
          type="text"
          id="campo61_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo61_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo61_fecha" />
        <label for="campo62_nombre">Cat√©ter y tipo 5</label
        ><input
          type="text"
          id="campo62_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo62_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo62_fecha" />
        <label for="campo63_nombre">Cat√©ter y tipo 6</label
        ><input
          type="text"
          id="campo63_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo63_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo63_fecha" />
        <label for="campo64_nombre">Cat√©ter y tipo 7</label
        ><input
          type="text"
          id="campo64_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo64_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo64_fecha" />
        <label for="campo65_nombre">Cat√©ter y tipo 8</label
        ><input
          type="text"
          id="campo65_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo65_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo65_fecha" />
        <label for="campo66_nombre">Cat√©ter y tipo 9</label
        ><input
          type="text"
          id="campo66_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo66_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo66_fecha" />
        <label for="campo67_nombre">Cat√©ter y tipo 10</label
        ><input
          type="text"
          id="campo67_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo67_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo67_fecha" />
        <label for="campo68_nombre">Cat√©ter y tipo 11</label
        ><input
          type="text"
          id="campo68_nombre"
          placeholder="Nombre del cat√©ter"
        /><label for="campo68_fecha">Fecha de inserci√≥n</label
        ><input type="date" id="campo68_fecha" />
      </div>
    </div>

    <!--  ‚Üì pega desde aqu√≠  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SCRIPTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <script>
      /*******************  utilidades de fecha  ************************/
      const MILIS_DIA = 86_400_000;
      const isoLocal = (d) => {
        const z = d.getTimezoneOffset() * 60_000;
        return new Date(d - z).toISOString().slice(0, 10); // yyyy‚Äëmm‚Äëdd
      };
      // ‚Üí fecha que debe imprimirse en la gr√°fica
      function fechaParaGrafica(fIng) {
        const h = new Date();
        const ingresoHoy = new Date(fIng + "T00:00");
        let base = new Date(h.getHours() < 8 ? h : new Date(+h + MILIS_DIA));
        if (+base < +ingresoHoy) base = ingresoHoy; // nunca antes del ingreso
        return isoLocal(base);
      }
      /*****************************************************************/

      let boxActual = null;
      const $boxes = document.getElementById("boxes");
      const $boxNum = document.getElementById("box-num");
      const $paginas = document.querySelectorAll(".pagina");
      const $btnBorrar = document.getElementById("btn-borrar");
      const $fechaIng = document.getElementById("fecha_ingreso");
      const $fechaGraf = document.getElementById("fecha");
      const $hojaNum = document.getElementById("campo72");

      /*******************  construcci√≥n de botones de Box  ************/
      for (let i = 1; i <= 12; i++) {
        const b = document.createElement("button");
        b.className = "btn-box";
        b.dataset.box = i;
        b.textContent = "Box " + i;
        $boxes.appendChild(b);
      }
      /*******************  helpers  ***********************************/
      const allInputs = () => [...document.querySelectorAll("input,textarea")];
      const disableAll = (flg) =>
        allInputs().forEach((el) => {
          if (el.id !== "fecha_ingreso") el.disabled = flg;
        });
      const loadDatos = () => {
        const d = JSON.parse(
          localStorage.getItem(`box${boxActual}_datos`) || "{}"
        );
        allInputs().forEach((el) => (el.value = d[el.id] || ""));
      };
      const saveDatos = () => {
        const d = {};
        allInputs().forEach((el) => (d[el.id] = el.value));
        localStorage.setItem(`box${boxActual}_datos`, JSON.stringify(d));
      };
      const diasDesdeIngreso = (fIng) =>
        Math.floor((Date.now() - Date.parse(fIng)) / MILIS_DIA) + 1;
      /*******************  selecci√≥n de p√°gina ***********************/
      document.addEventListener("click", (e) => {
        const pagBtn = e.target.closest("[data-pag]");
        if (pagBtn) {
          const n = pagBtn.dataset.pag;
          $paginas.forEach((p, i) => p.classList.toggle("active", i + 1 == n));
          localStorage.setItem("pagina_activa", n);
        }
        const boxBtn = e.target.closest(".btn-box");
        if (boxBtn) seleccionarBox(+boxBtn.dataset.box);
      });
      /*******************  selecci√≥n de Box ***************************/
      function seleccionarBox(n) {
        boxActual = n;
        // highlight
        document
          .querySelectorAll(".btn-box")
          .forEach((b) =>
            b.classList.toggle("btn-box--active", +b.dataset.box === n)
          );
        $boxNum.textContent = n;
        // fecha ingreso localStorage
        const clave = `box${n}_fechaIng`;
        const fIng = localStorage.getItem(clave);
        if (!fIng) {
          // 1¬™ vez ‚Üí pedir fecha y bloquear resto
          disableAll(true);
          $fechaIng.disabled = false;
          $fechaIng.value = "";
          $fechaIng.focus();
        } else {
          $fechaIng.value = fIng;
          postFechaIngreso(fIng);
        }
        loadDatos();
      }
      /*******************  tras fijar fecha de ingreso ***************/
      function postFechaIngreso(fIng) {
        // bloqueamos fecha_ingreso para no editarla
        $fechaIng.disabled = true;
        // habilitamos todo lo dem√°s
        disableAll(false);
        // relleno autom√°ticos
        $fechaGraf.value = fechaParaGrafica(fIng);
        $hojaNum.value = diasDesdeIngreso(fIng);
        saveDatos();
      }
      /*******************  change en fecha ingreso *******************/
      $fechaIng.addEventListener("change", () => {
        const v = $fechaIng.value.trim();
        if (!/\d{4}-\d{2}-\d{2}/.test(v)) return alert("Formato yyyy-mm-dd");
        localStorage.setItem(`box${boxActual}_fechaIng`, v);
        postFechaIngreso(v);
      });
      /*******************  auto‚Äësave *************************/
      document.addEventListener("input", (e) => {
        if (!boxActual) return;
        saveDatos();
      });
      /*******************  bot√≥n borrar *************************/
      $btnBorrar.addEventListener("click", () => {
        if (!boxActual) return;
        if (!confirm(`Borrar el Box ${boxActual}?`)) return;
        localStorage.removeItem(`box${boxActual}_datos`);
        localStorage.removeItem(`box${boxActual}_fechaIng`);
        allInputs().forEach((el) => (el.value = ""));
        disableAll(true);
        $fechaIng.disabled = true;
        $boxNum.textContent = "";
        document
          .querySelectorAll(".btn-box")
          .forEach((b) => b.classList.remove("btn-box--active"));
        boxActual = null;
      });
      /*******************  arranque *************************/
      window.addEventListener("DOMContentLoaded", () => {
        // √∫ltima p√°gina
        const p = localStorage.getItem("pagina_activa") || "1";
        document.querySelector(`[data-pag="${p}"]`)?.click();
        // nada habilitado hasta elegir Box
        disableAll(true);
      });
    </script>
  </body>
</html>
